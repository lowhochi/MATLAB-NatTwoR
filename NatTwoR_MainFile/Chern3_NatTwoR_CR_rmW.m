load('DataChern2_NatTwoR_CR_rmW.mat');
% Part(1) Check that C1122, C1212, C1221, C2112, C2121, C2211 are -rho/6
% % testVec1 =[Chern_in_aV(1,1,2,2), Chern_in_aV(1,2,1,2), Chern_in_aV(1,2,2,1),...
% %     Chern_in_aV(2,1,1,2), Chern_in_aV(2,1,2,1), Chern_in_aV(2,2,1,1)];
% %  
% % phiW = d2w_uu - 6*conj(u)/(1+u*conj(u))*dw_u + 12*conj(u)^2/(1+u*conj(u))^2*w;
% % rhoSub = i*(phiW-conj(phiW)) + 16*theta + 12*i*(aV-conj(aV));
% % 
% % for j=1:6
% %     temp = testVec1(j)+rhoSub/6;
% %     temp = subs(temp,Y0,1+u*conj(u));
% %     temp = complex_simple3(temp,[u,w,dw_u,d2w_uu,aV,theta]);
% %     testVec1(j)=temp;
% % end
% % 
% % % Part(2) C1222, C2122, C2212, C2221 and C2222 are zero.
% % testVec2 = [Chern_in_aV(1,2,2,2), Chern_in_aV(2,1,2,2),...
% %     Chern_in_aV(2,2,1,2), Chern_in_aV(2,2,2,1), Chern_in_aV(2,2,2,2)];
% % % disp(testVec2);
% % MVarTemp = [w, dw_conjMu, dw_vnormv, dw_u, d2w_uu, d2w_uconjMu,...
% %     d2w_conjMuconjMu, u];
% % % Part(3) Check that C1112 = C1211, C1121=C2111 andd C1121=conj(C1112);
% % C1112 = ChernTwo(1,1,1,2);
% % C1121 = ChernTwo(1,1,2,1);
% % C1211 = ChernTwo(1,2,1,1);
% % C2111 = ChernTwo(2,1,1,1);
% % test301 = C1112-C1211;
% % test301 = complex_simple3(test301,MVarTemp);
% % test302 = C1121-C2111;
% % test302 = complex_simple3(test302,MVarTemp);
% % test303 = C1121-conj(C1112);
% % test303 = complex_simple3(test303,MVarTemp);

% Part(4) Check that C1111 is real.
C1111 = ChernTwo(1,1,1,1);
symSetC1111 = sort(symvar(C1111));
subSetC1111 = sym('subSet',[1,length(symSetC1111)]);

for j=1:length(symSetC1111)
    myVar = symSetC1111(j);
    myString = string(myVar);
    if strfind(myString,'d2w')==1
        subSetC1111(j)=0;
    elseif strfind(myString,'dw')==1
        subSetC1111(j)=0;
    elseif myVar==w
        subSetC1111(j)=0;
    else
        subSetC1111(j)=myVar;
    end
end

C1111New = subs(C1111,symSetC1111,subSetC1111);

Gset =[G11_2, G11_3, G12_3, G22_1, G22_3, G23_1, G31_2, G33_1, G33_2,...
    d2G11_2_by11, d2G11_2_by12, d2G11_2_by22, d2G11_3_by11, d2G11_3_by12,...
    d2G11_3_by13, d2G11_3_by22, d2G11_3_by23, d2G11_3_by33, d2G12_3_by11,...
    d2G12_3_by12, d2G12_3_by13, d2G12_3_by22, d2G12_3_by23, d2G12_3_by33,...
    d2G22_1_by11, d2G22_1_by12, d2G22_1_by13, d2G22_1_by22, d2G22_1_by23,...
    d2G22_1_by33, d2G22_3_by22, d2G22_3_by23, d2G22_3_by33, d2G23_1_by11,...
    d2G23_1_by12, d2G23_1_by13, d2G23_1_by22, d2G31_2_by11, d2G31_2_by12,...
    d2G31_2_by13, d2G31_2_by22, d2G31_2_by23, d2G31_2_by33, d2G33_1_by11,...
    d2G33_1_by12, d2G33_1_by13, d2G33_1_by22, d2G33_1_by23, d2G33_1_by33,...
    d2G33_2_by11, d2G33_2_by12, d2G33_2_by13, d2G33_2_by22, d2G33_2_by23,...
    d2G33_2_by33, dG11_2_by1, dG11_2_by2, dG11_3_by1, dG11_3_by2, dG11_3_by3,...
    dG12_3_by1, dG12_3_by2, dG12_3_by3, dG22_1_by1, dG22_1_by2, dG22_1_by3, dG22_3_by2,...
    dG22_3_by3, dG23_1_by1, dG23_1_by2, dG31_2_by1, dG31_2_by2, dG31_2_by3, dG33_1_by1,...
    dG33_1_by2, dG33_1_by3, dG33_2_by1, dG33_2_by2, dG33_2_by3];
[termVec,gVec] = coeffs(C1111New,Gset);
% save('DataTemp_Oct10.mat')
myNum = length(gVec);
checkVec = zeros(1,myNum); %Okay. checkVec(j)=1 for all j.
for j=1:myNum
    temp = termVec(j)-conj(termVec(j));
    temp = complex_simple3(temp,u);
    if temp==0
        checkVec(j)=1;
    end
    clear temp
end
% save('DataTemp_Oct10.mat','checkVec','-append');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%% Check C1111 is correctly simplified and updated.
load('DataChern1_Part2_NatTwoR_CR_rmW.mat'); %Part-1 file
C1111 = Chern_in_aV(1,1,1,1);
C1111 = subs(C1111, Y0, 1+u*conj(u));
C1111 = subs(C1111, dtheta_conjMu, conj(dtheta_Mu));

H0= (2*theta + i*aV - i*conj(aV));
Y = (1+u*conj(u));
term1 = H0*Y^6*(daV_u*daV_conju + daV_u*conj(daV_u));

term2 = Y^4*((-16/3)*theta^3 + (-40/3*i*aV + 16/3*i*conj(aV))*theta^2 ...
    +(28/3*aV^2 - 32/3*aV*conj(aV) + 4/3*conj(aV)^2)*theta ...
    + 2*i*aV^3 - 4*i*aV^2*conj(aV) + 2*i*aV*conj(aV)^2);

term3 = Y^4*H0^2*(i/6*d2w_uu - i/6*conj(d2w_uu))...
    + Y^4*H0*(2*daV_u*dw_u + w*d2aV_uu + 2*conj(daV_u)*conj(dw_u)...
    +conj(w)*conj(d2aV_uu));

term4 = Y^4*(2*i*w*(-2*daV_u^2 + daV_u*conj(daV_conju))...
    +2*i*conj(w)*(-daV_conju*conj(daV_u)+ 2*conj(daV_u)^2) );

term5 = Y^4*H0*(-4*i*dtheta_vnormv)...
    +Y^4*(daV_u*(-4*dtheta_Mu -2*i*daV_Mu + i*conj(daV_conjMu))...
        +conj(daV_u)*(-2*conj(dtheta_Mu) - i*daV_conjMu +2*i*conj(daV_Mu)) )...
    +Y^4*H0*(-d2aV_conjuconjMu + 2*daV_vnormv);

term6 = -i*Y^3*H0^2*(conj(u)*dw_u - u*conj(dw_u))...
    + Y^3*H0*(-6*conj(u)*w*daV_u - 6*u*conj(w)*conj(daV_u));

term7 = Y^2*H0*(-d2w_uconjMu - conj(d2w_uconjMu))...
    +Y^2*(dw_conjMu*(4*i*daV_u - i*conj(daV_conju))...
        + conj(dw_conjMu)*(i*daV_conju - 4*i*conj(daV_u)))...
    +Y^2*dw_u*(-2*conj(dtheta_Mu) + i*conj(daV_Mu) - i*daV_conjMu)...
    +Y^2*conj(dw_u)*(-2*dtheta_Mu + i*conj(daV_conjMu) - i*daV_Mu)...
    +Y^2*dw_u*conj(w)*(-i*daV_conju + 2*i*conj(daV_u))...
    +Y^2*conj(dw_u)*w*(i*conj(daV_conju) - 2*i*daV_u);

term8 = Y^2*H0*(dw_u*conj(dw_u))...
    +Y^2*w*(2*i*conj(u)^2*H0^2+2*i*d2aV_uconjMu-i*conj(d2aV_conjuMu))...
    +Y^2*conj(w)*(-2*i*u^2*H0^2+i*d2aV_conjuMu-2*i*conj(d2aV_uconjMu));

term9 = Y^2*(2*d2theta_MuconjMu-i*conj(d2aV_MuconjMu)+2*i*d2aV_MuconjMu)...
    + 4*Y*H0*(conj(u)*dw_conjMu + u*conj(dw_conjMu) - u*conj(w)*dw_u...
        - conj(u)*w*conj(dw_u) + 4*w*conj(w))...
    + Y*w*conj(w)*(8*i*(u*daV_u - conj(u)*conj(daV_u))...
        +4*i*(conj(u)*daV_conju - u*conj(daV_conju)));

term10 = Y*(4*u*conj(w)*(2*dtheta_Mu + i*daV_Mu - i*conj(daV_conjMu))...
    +4*conj(u)*w*(2*conj(dtheta_Mu) + i*daV_conjMu - i*conj(daV_Mu)))...
    +w*conj(w)*(-40*theta-24*i*aV+24*i*conj(aV));

term11 = i*(-d2w_conjMuconjMu + conj(d2w_conjMuconjMu))...
    +2*i*(-conj(w)*dw_vnormv + w*conj(dw_vnormv))...
    +i*(-dw_u*conj(dw_conjMu) + conj(dw_u)*dw_conjMu)...
    -(4*i*u/Y)*conj(w)*dw_conjMu + (4*i*conj(u)/Y)*w*conj(dw_conjMu);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% The correction term: term12

term12 = d2aV_MuconjMu*(u*conj(u)*1i + 1i)^2*1i;

% term12 = Y^4*(-i*daV_u*conj(daV_conjMu)-2*i*conj(daV_u)*conj(daV_Mu)...
%     -2*i*aV*conj(daV_vnormv) -4*theta*conj(daV_vnormv)...
%     +i*conj(daV_u)*conj(daV_Mu) +2*i*daV_u*conj(daV_conjMu)...
%     +2*i*conj(aV)*conj(daV_vnormv) );
% 
% term12 = term12+ Y^2*(-i*d2aV_MuconjMu +2*i*aV*conj(daV_vnormv)...
%     -i*daV_u*conj(daV_conjMu) +4*theta*conj(daV_vnormv)...
%     -2*i*conj(aV)*conj(daV_vnormv)+i*conj(daV_u)*conj(daV_Mu)...
%     -4*i*u*conj(u)*conj(aV)*conj(daV_vnormv)...
%     +2*i*u*conj(u)*conj(daV_u)*conj(daV_Mu)... 
%     +2*i*u^2*conj(u)^2*aV*conj(daV_vnormv)...
%     -i*u^2*conj(u)^2*daV_u*conj(daV_conjMu)...
%     +4*theta*u^2*conj(u)^2*conj(daV_vnormv)...
%     +4*i*u*conj(u)*aV*conj(daV_vnormv)...
%     -2*i*u*conj(u)*daV_u*conj(daV_conjMu)...
%     +8*theta*u*conj(u)*conj(daV_vnormv)...
%     -2*i*u^2*conj(u)^2*conj(aV)*conj(daV_vnormv)...
%     +i*u^2*conj(u)^2*conj(daV_u)*conj(daV_Mu) );

test1111 = term1 + term2 + term3 + term4 + term5 + term6...
    + term7 + term8 + term9 + term10 + term11 + term12;

diff1111= C1111-test1111;
diff1111= complex_simple3(diff1111, MVarChern1S);

%% Preparation for Weyl-Chern comparison
load('DataChern1_Part2_NatTwoR_CR_rmW.mat')
for j=1:16
    m = indexChern(j,1);
    n = indexChern(j,2);
    k = indexChern(j,3);
    ll = indexChern(j,4);
    temp = Chern_in_aV(m,n,k,ll);
    temp = subs(temp, Y0, 1+u*conj(u));
    Chern_in_aV(m,n,k,ll) = temp;
end
variable_of_Chern_in_aV = symvar(Chern_in_aV);
save('Data_Chern_in_aV_Oct10.mat','Chern_in_aV','variable_of_Chern_in_aV');
