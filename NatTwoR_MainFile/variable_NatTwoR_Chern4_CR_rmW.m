% variable_NatTwoR_Chern4_CR_rmW.m

h11R = -mu1*conj(mu1)*G12_3 - mu2*conj(mu2)*G23_1 - mu3*conj(mu3)*G31_2...
    + 1/(2*norm_of_v)*(G11_2*v1*v3 - G11_3*v1*v2 - G22_1*v3*v2...
    + G22_3*v2*v1 + G33_1*v2*v3 - G33_2*v1*v3);
T4R = -i/(2*norm_of_v)*v1*(mu3*G11_2 - mu2*G11_3 + mu1*G12_3)...
    -i/(2*norm_of_v)*v2*(-mu3*G22_1 + mu2*G23_1 + mu1*G22_3)...
    -i/(2*norm_of_v)*v3*(mu3*G31_2 + mu2*G33_1 -mu1*G33_2);
aMR0 = -i*(conj(u)^2-1)*(v1*(G23_1+G31_2) + v2*G11_3 - v3*G11_2)...
    -2*i*conj(u)*(-v1*G22_3 + v2*(G12_3+G31_2) + v3*G22_1)...
    -(conj(u)^2+1)*(v1*G33_2 - v2*G33_1 + v3*(G12_3+G23_1));
aMR = 1/(2*(1+u*conj(u))^2)*aMR0;
clear aMR0
aVR = 1/(2*(1+u*conj(u))^2)*(i*(mu1*conj(mu1)+mu3*conj(mu3))*G23_1...
    +i*(mu1*conj(mu1)+mu2*conj(mu2))*G31_2...
    +i*(mu2*conj(mu2)+mu3*conj(mu3))*G12_3...
    -i*conj(mu1)*mu3*G11_2 + i*conj(mu1)*mu2*G11_3...
    +i*conj(mu2)*mu3*G22_1 - i*conj(mu2)*mu1*G22_3...
    +i*conj(mu3)*mu1*G33_2 -i*conj(mu3)*mu2*G33_1);
bVR = 1/(2*(1+u*conj(u))^2)*(-i*mu2^2*G23_1-i*mu3^2*G31_2-i*mu1^2*G12_3...
    -i*mu1*mu3*G11_2 + i*mu1*mu2*G11_3 + i*mu2*mu3*G22_1...
    -i*mu2*mu1*G22_3 + i*mu3*mu1*G33_2 - i*mu3*mu2*G33_1); 

variableSet0 = [aM, aV, bV, h11, T4];
subSet0 = [aMR, aVR, bVR, h11R, T4R];

% %
d2G12_3 =[d2G12_3_MuMu, d2G12_3_MuconjMu, d2G12_3_Muvnormv,... 
    d2G12_3_Muu, 0;
    d2G12_3_conjMuMu, d2G12_3_conjMuconjMu, d2G12_3_conjMuvnormv,...
    0, d2G12_3_conjMuconju;
    d2G12_3_vnormvMu, d2G12_3_vnormvconjMu, d2G12_3_vnormvvnormv,...
    d2G12_3_vnormvu, d2G12_3_vnormvconju;
    0, 0, 0, 0, 0;
    0, 0, 0, 0, 0];
% %
d2G23_1 =[d2G23_1_MuMu, d2G23_1_MuconjMu, d2G23_1_Muvnormv,...
    d2G23_1_Muu, 0;
    d2G23_1_conjMuMu, d2G23_1_conjMuconjMu, d2G23_1_conjMuvnormv,...
    0, d2G23_1_conjMuconju;
    d2G23_1_vnormvMu, d2G23_1_vnormvconjMu, d2G23_1_vnormvvnormv,...
    d2G23_1_vnormvu, d2G23_1_vnormvconju;
    0, 0, 0, 0, 0;
    0, 0, 0, 0, 0];
% %
d2G31_2 =[d2G31_2_MuMu, d2G31_2_MuconjMu, d2G31_2_Muvnormv,...
    d2G31_2_Muu, 0;
    d2G31_2_conjMuMu, d2G31_2_conjMuconjMu, d2G31_2_conjMuvnormv,...
    0, d2G31_2_conjMuconju;
    d2G31_2_vnormvMu, d2G31_2_vnormvconjMu, d2G31_2_vnormvvnormv,...
    d2G31_2_vnormvu, d2G31_2_vnormvconju;
    0, 0, 0, 0, 0;
    0, 0, 0, 0, 0];
% %
d2G11_2 =[d2G11_2_MuMu, d2G11_2_MuconjMu, d2G11_2_Muvnormv,... 
    d2G11_2_Muu, 0;
    d2G11_2_conjMuMu, d2G11_2_conjMuconjMu, d2G11_2_conjMuvnormv,...
    0, d2G11_2_conjMuconju;
    d2G11_2_vnormvMu, d2G11_2_vnormvconjMu, d2G11_2_vnormvvnormv,...
    d2G11_2_vnormvu, d2G11_2_vnormvconju;
    0, 0, 0, 0, 0;
    0, 0, 0, 0, 0];
% %
d2G11_3 =[d2G11_3_MuMu, d2G11_3_MuconjMu, d2G11_3_Muvnormv,...
    d2G11_3_Muu, 0;
    d2G11_3_conjMuMu, d2G11_3_conjMuconjMu, d2G11_3_conjMuvnormv,...
    0, d2G11_3_conjMuconju;
    d2G11_3_vnormvMu, d2G11_3_vnormvconjMu, d2G11_3_vnormvvnormv,...
    d2G11_3_vnormvu, d2G11_3_vnormvconju;
    0, 0, 0, 0, 0;
    0, 0, 0, 0, 0];
% %
d2G22_1 =[d2G22_1_MuMu, d2G22_1_MuconjMu, d2G22_1_Muvnormv,...
    d2G22_1_Muu, 0;
    d2G22_1_conjMuMu, d2G22_1_conjMuconjMu, d2G22_1_conjMuvnormv,...
    0, d2G22_1_conjMuconju;
    d2G22_1_vnormvMu, d2G22_1_vnormvconjMu, d2G22_1_vnormvvnormv,...
    d2G22_1_vnormvu, d2G22_1_vnormvconju;
    0, 0, 0, 0, 0;
    0, 0, 0, 0, 0];
% %
d2G22_3 =[d2G22_3_MuMu, d2G22_3_MuconjMu, d2G22_3_Muvnormv,...
    d2G22_3_Muu, 0;
    d2G22_3_conjMuMu, d2G22_3_conjMuconjMu, d2G22_3_conjMuvnormv,...
    0, d2G22_3_conjMuconju;
    d2G22_3_vnormvMu, d2G22_3_vnormvconjMu, d2G22_3_vnormvvnormv,...
    d2G22_3_vnormvu, d2G22_3_vnormvconju;
    0, 0, 0, 0, 0;
    0, 0, 0, 0, 0];
% %
d2G33_1 =[d2G33_1_MuMu, d2G33_1_MuconjMu, d2G33_1_Muvnormv,...
    d2G33_1_Muu, 0;
    d2G33_1_conjMuMu, d2G33_1_conjMuconjMu, d2G33_1_conjMuvnormv,...
    0, d2G33_1_conjMuconju;
    d2G33_1_vnormvMu, d2G33_1_vnormvconjMu, d2G33_1_vnormvvnormv,...
    d2G33_1_vnormvu, d2G33_1_vnormvconju;
    0, 0, 0, 0, 0;
    0, 0, 0, 0, 0];
% %
d2G33_2 = [d2G33_2_MuMu, d2G33_2_MuconjMu, d2G33_2_Muvnormv,... 
    d2G33_2_Muu, 0;
    d2G33_2_conjMuMu, d2G33_2_conjMuconjMu, d2G33_2_conjMuvnormv,...
    0, d2G33_2_conjMuconju;
    d2G33_2_vnormvMu, d2G33_2_vnormvconjMu, d2G33_2_vnormvvnormv,...
    d2G33_2_vnormvu, d2G33_2_vnormvconju;
    0, 0, 0, 0, 0;
    0, 0, 0, 0, 0];
% %
variableSetConjMuConjMu = [d2G11_2_conjMuconjMu, d2G11_3_conjMuconjMu,...
    d2G12_3_conjMuconjMu, d2G22_1_conjMuconjMu, d2G22_3_conjMuconjMu,...
    d2G23_1_conjMuconjMu, d2G31_2_conjMuconjMu, d2G33_1_conjMuconjMu,...
    d2G33_2_conjMuconjMu];
subSetConjMuConjMu = [d2G11_2_conjMuconjMuSub, d2G11_3_conjMuconjMuSub,...
    d2G12_3_conjMuconjMuSub, d2G22_1_conjMuconjMuSub, d2G22_3_conjMuconjMuSub,...
    d2G23_1_conjMuconjMuSub, d2G31_2_conjMuconjMuSub, d2G33_1_conjMuconjMuSub,...
    d2G33_2_conjMuconjMuSub];

% %
CVarG2 = [G12_3, G23_1, G31_2, G11_2, G11_3, G22_1, G22_3, G33_1, G33_2,...
    dG12_3_Mu, dG12_3_conjMu, dG12_3_vnormv,...
    dG23_1_Mu, dG23_1_conjMu, dG23_1_vnormv,...
    dG31_2_Mu, dG31_2_conjMu, dG31_2_vnormv,...
    dG11_2_Mu, dG11_2_conjMu, dG11_2_vnormv,...
    dG11_3_Mu, dG11_3_conjMu, dG11_3_vnormv,...
    dG22_1_Mu, dG22_1_conjMu, dG22_1_vnormv,...
    dG22_3_Mu, dG22_3_conjMu, dG22_3_vnormv,...
    dG33_1_Mu, dG33_1_conjMu, dG33_1_vnormv,...
    dG33_2_Mu, dG33_2_conjMu, dG33_2_vnormv, u];

dCVarG2 = sym('dCVarG2',[5,37]);
dCVarG2(:,1) = [dG12_3_Mu; dG12_3_conjMu; dG12_3_vnormv; 0; 0]; %G12_3
dCVarG2(:,2) = [dG23_1_Mu; dG23_1_conjMu; dG23_1_vnormv; 0; 0]; %G23_1
dCVarG2(:,3) = [dG31_2_Mu; dG31_2_conjMu; dG31_2_vnormv; 0; 0]; %G31_2
dCVarG2(:,4) = [dG11_2_Mu; dG11_2_conjMu; dG11_2_vnormv; 0; 0]; %G11_2
dCVarG2(:,5) = [dG11_3_Mu; dG11_3_conjMu; dG11_3_vnormv; 0; 0]; %G11_3
dCVarG2(:,6) = [dG22_1_Mu; dG22_1_conjMu; dG22_1_vnormv; 0; 0]; %G22_1
dCVarG2(:,7) = [dG22_3_Mu; dG22_3_conjMu; dG22_3_vnormv; 0; 0]; %G22_3
dCVarG2(:,8) = [dG33_1_Mu; dG33_1_conjMu; dG33_1_vnormv; 0; 0]; %G33_1
dCVarG2(:,9) = [dG33_2_Mu; dG33_2_conjMu; dG33_2_vnormv; 0; 0]; %G33_2
%
dCVarG2(:,10)= transpose(d2G12_3(1,:)); %dG12_3_Mu
dCVarG2(:,11)= transpose(d2G12_3(2,:)); %dG12_3_conjMu
dCVarG2(:,12)= transpose(d2G12_3(3,:)); %dG12_3_vnormv
dCVarG2(:,13)= transpose(d2G23_1(1,:)); %dG23_1_Mu
dCVarG2(:,14)= transpose(d2G23_1(2,:)); %dG23_1_conjMu
dCVarG2(:,15)= transpose(d2G23_1(3,:)); %dG23_1_vnormv
dCVarG2(:,16)= transpose(d2G31_2(1,:)); %dG31_2_Mu
dCVarG2(:,17)= transpose(d2G31_2(2,:)); %dG31_2_conjMu
dCVarG2(:,18)= transpose(d2G31_2(3,:)); %dG31_2_vnormv
dCVarG2(:,19)= transpose(d2G11_2(1,:)); %dG11_2_Mu
dCVarG2(:,20)= transpose(d2G11_2(2,:)); %dG11_2_conjMu
dCVarG2(:,21)= transpose(d2G11_2(3,:)); %dG11_2_vnormv
dCVarG2(:,22)= transpose(d2G11_3(1,:)); %dG11_3_Mu
dCVarG2(:,23)= transpose(d2G11_3(2,:)); %dG11_3_conjMu
dCVarG2(:,24)= transpose(d2G11_3(3,:)); %dG11_3_vnormv
dCVarG2(:,25)= transpose(d2G22_1(1,:)); %dG22_1_Mu
dCVarG2(:,26)= transpose(d2G22_1(2,:)); %dG22_1_conjMu
dCVarG2(:,27)= transpose(d2G22_1(3,:)); %dG22_1_vnormv
dCVarG2(:,28)= transpose(d2G22_3(1,:)); %dG22_3_Mu
dCVarG2(:,29)= transpose(d2G22_3(2,:)); %dG22_3_conjMu
dCVarG2(:,30)= transpose(d2G22_3(3,:)); %dG22_3_vnormv
dCVarG2(:,31)= transpose(d2G33_1(1,:)); %dG33_1_Mu
dCVarG2(:,32)= transpose(d2G33_1(2,:)); %dG33_1_conjMu
dCVarG2(:,33)= transpose(d2G33_1(3,:)); %dG33_1_vnormv
dCVarG2(:,34)= transpose(d2G33_2(1,:)); %dG33_2_Mu
dCVarG2(:,35)= transpose(d2G33_2(2,:)); %dG33_2_conjMu
dCVarG2(:,36)= transpose(d2G33_2(3,:)); %dG33_2_vnormv
dCVarG2(:,37) = [0; 0; 0; 1; 0]; %u