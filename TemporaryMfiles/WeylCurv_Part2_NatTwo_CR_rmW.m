load('Data_WeylChern_Part1_May30.mat');
assumeAlso([x y z u1 u2 gamma], 'real');
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Put w = f(x,u) in a general setting. Check WeylX.
% Define terms in Gij_k and their derivatives.
variableFour_Nat_CR_rmW
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% df = df_NatTwo_WeylChern_CR_rmW(f, CVar5, dCVar5, u)
f = -i/2*mu1*(mu3*G11_2 + mu1*G12_3 - mu2*G11_3)...
    -i/2*mu2*(-mu3*G22_1 + mu1*G22_3 + mu2*G23_1)...
    -i/2*mu3*(mu3*G31_2 - mu1*G33_2 + mu2*G33_1);
dfdu = complexdiff3(f,u,0);
d2fdu2 = complexdiff3(dfdu,u,0);
phiF = d2fdu2 - 6*conj(u)/(1+u*conj(u))*dfdu + 12*conj(u)^2/(1+u*conj(u))^2*f;
rhoSub = i*(phiW-conj(phiW)) - i*(phiF-conj(phiF));
h11Sub = -mu1*conj(mu1)*G12_3 - mu2*conj(mu2)*G23_1 - mu3*conj(mu3)*G31_2...
    + 1/(2*norm_of_v)*(G11_2*v1*v3 - G11_3*v1*v2 - G22_1*v3*v2...
    + G22_3*v2*v1 + G33_1*v2*v3 - G33_2*v1*v3);
T4Sub = -i/(2*norm_of_v)*v1*(mu3*G11_2 - mu2*G11_3 + mu1*G12_3)...
    -i/(2*norm_of_v)*v2*(-mu3*G22_1 + mu2*G23_1 + mu1*G22_3)...
    -i/(2*norm_of_v)*v3*(mu3*G31_2 + mu2*G33_1 -mu1*G33_2);
aMuSub0 = -i*(conj(u)^2-1)*(v1*(G23_1+G31_2) + v2*G11_3 - v3*G11_2)...
    -2*i*conj(u)*(-v1*G22_3 + v2*(G12_3+G31_2) + v3*G22_1)...
    -(conj(u)^2+1)*(v1*G33_2 - v2*G33_1 + v3*(G12_3+G23_1));
aMuSub = 1/(2*(1+u*conj(u))^2)*aMuSub0;
aVSub = 1/(2*(1+u*conj(u))^2)*(i*(mu1*conj(mu1)+mu3*conj(mu3))*G23_1...
    +i*(mu1*conj(mu1)+mu2*conj(mu2))*G31_2...
    +i*(mu2*conj(mu2)+mu3*conj(mu3))*G12_3...
    -i*conj(mu1)*mu3*G11_2 + i*conj(mu1)*mu2*G11_3...
    +i*conj(mu2)*mu3*G22_1 - i*conj(mu2)*mu1*G22_3...
    +i*conj(mu3)*mu1*G33_2 -i*conj(mu3)*mu2*G33_1);
bVSub = 1/(2*(1+u*conj(u))^2)*(-i*mu2^2*G23_1-i*mu3^2*G31_2-i*mu1^2*G12_3...
    -i*mu1*mu3*G11_2 + i*mu1*mu2*G11_3 + i*mu2*mu3*G22_1...
    -i*mu2*mu1*G22_3 + i*mu3*mu1*G33_2 - i*mu3*mu2*G33_1); 

VarSet = [h11, T4, aMu, aV, bV, rho];
VarSubSet = [h11Sub, T4Sub, aMuSub, aVSub, bVSub, rhoSub];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
dh11N = [dh11_Mu, dh11_conjMu, dh11_vnormv, dh11_u, dh11_conju];
dh11Vec = df_NatTwo_WeylChern_CR_rmW(h11Sub, CVar5, dCVar5, u);
dh11_uSub = dh11Vec(4);
dh11_MuSub = dh11Vec(1);

d2h11N = [d2h11_uu, d2h11_uconju, d2h11_uMu, d2h11_uconjMu,...
    d2h11_conjuconju, d2h11_conjuMu, d2h11_conjuconjMu, d2h11_MuconjMu];
d2h11_uVec = df_NatTwo_WeylChern_CR_rmW(dh11_uSub, CVar5, dCVar5, u);
d2h11_MuVec =  df_NatTwo_WeylChern_CR_rmW(dh11_MuSub, CVar5, dCVar5, u);
d2h11Vec = [d2h11_uVec(4), d2h11_uVec(5), d2h11_uVec(1), d2h11_uVec(2),...
    conj(d2h11_uVec(4)), conj(d2h11_uVec(2)), conj(d2h11_uVec(1)),...
    d2h11_MuVec(2)];

dT4N = [dT4_conjMu, dT4_u, dT4_conju];
dT4Vec0 = df_NatTwo_WeylChern_CR_rmW(T4Sub, CVar5, dCVar5, u);
dT4Vec = [dT4Vec0(2), dT4Vec0(4), dT4Vec0(5)];

daMuN = [daMu_Mu, daMu_conjMu, daMu_u, daMu_conju];
daMuVec0 = df_NatTwo_WeylChern_CR_rmW(aMuSub, CVar5, dCVar5, u);
daMuVec = [daMuVec0(1), daMuVec0(2), daMuVec0(4), daMuVec0(5)];

dfVec0 = df_NatTwo_WeylChern_CR_rmW(f, CVar5, dCVar5, u);
dwN = [dw_conjMu, dw_vnormv, dw_u];
dwVec = [dfVec0(2), dfVec0(3), dfdu];

df_conjMuSub = dfVec0(2);
d2f_uVec0 = df_NatTwo_WeylChern_CR_rmW(dfdu, CVar5, dCVar5, u);
d2f_conjMuVec0 = df_NatTwo_WeylChern_CR_rmW(df_conjMuSub, CVar5, dCVar5, u);
d2wN = [d2w_uu, d2w_uconjMu, d2w_conjMuconjMu];
d2wVec = [d2fdu2, d2f_uVec0(2), d2f_conjMuVec0(2)];

MVar5 = [dG12_3_Mu, dG12_3_conjMu, dG12_3_vnormv,...
    dG23_1_Mu, dG23_1_conjMu, dG23_1_vnormv,...
    dG31_2_Mu, dG31_2_conjMu, dG31_2_vnormv,...
    dG11_2_Mu, dG11_2_conjMu, dG11_2_vnormv,...
    dG11_3_Mu, dG11_3_conjMu, dG11_3_vnormv,...
    dG22_1_Mu, dG22_1_conjMu, dG22_1_vnormv,...
    dG22_3_Mu, dG22_3_conjMu, dG22_3_vnormv,...
    dG33_1_Mu, dG33_1_conjMu, dG33_1_vnormv,...
    dG33_2_Mu, dG33_2_conjMu, dG33_2_vnormv,...
    d2G12_3_MuMu, d2G12_3_MuconjMu, d2G12_3_Muvnormv,...
    d2G12_3_conjMuconjMu, d2G12_3_conjMuvnormv, d2G12_3_vnormvvnormv,...
    d2G23_1_MuMu, d2G23_1_MuconjMu, d2G23_1_Muvnormv,...
    d2G23_1_conjMuconjMu, d2G23_1_conjMuvnormv, d2G23_1_vnormvvnormv,...
    d2G31_2_MuMu, d2G31_2_MuconjMu, d2G31_2_Muvnormv,...
    d2G31_2_conjMuconjMu, d2G31_2_conjMuvnormv, d2G31_2_vnormvvnormv,...
    d2G11_2_MuMu, d2G11_2_MuconjMu, d2G11_2_Muvnormv,...
    d2G11_2_conjMuconjMu, d2G11_2_conjMuvnormv, d2G11_2_vnormvvnormv,...
    d2G11_3_MuMu, d2G11_3_MuconjMu, d2G11_3_Muvnormv,...
    d2G11_3_conjMuconjMu, d2G11_3_conjMuvnormv, d2G11_3_vnormvvnormv,...
    d2G22_1_MuMu, d2G22_1_MuconjMu, d2G22_1_Muvnormv,...
    d2G22_1_conjMuconjMu, d2G22_1_conjMuvnormv, d2G22_1_vnormvvnormv,...
    d2G22_3_MuMu, d2G22_3_MuconjMu, d2G22_3_Muvnormv,...
    d2G22_3_conjMuconjMu, d2G22_3_conjMuvnormv, d2G22_3_vnormvvnormv,...
    d2G33_1_MuMu, d2G33_1_MuconjMu, d2G33_1_Muvnormv,...
    d2G33_1_conjMuconjMu, d2G33_1_conjMuvnormv, d2G33_1_vnormvvnormv,...
    d2G33_2_MuMu, d2G33_2_MuconjMu, d2G33_2_Muvnormv,...
    d2G33_2_conjMuconjMu, d2G33_2_conjMuvnormv, d2G33_2_vnormvvnormv];
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
WeylXf = sym('WeylXf',[2 2 2 2]);
for j=1:16
    m = indexChern(j,1);
    n = indexChern(j,2);
    p = indexChern(j,3);
    q = indexChern(j,4);
    temp = WeylX(m,n,p,q);
    temp = subs(temp, VarSet, VarSubSet); %h11,T4,aMu,aV,bV,rho
    temp = subs(temp, dh11N, dh11Vec); 
    %dh11_Mu, dh11_conjMu, dh11_vnormv, dh11_u, dh11_conju
    temp = subs(temp, d2h11N, d2h11Vec);
    temp = subs(temp, dT4N, dT4Vec); %dT4_conjMu, dT4_u, dT4_conju
    temp = subs(temp, daMuN, daMuVec); 
    %daMu_Mu, daMu_conjMu, daMu_u, daMu_conju
    temp = subs(temp, w, f);
    temp = subs(temp, dwN, dwVec);
    temp = subs(temp, d2wN, d2wVec);
    WeylXf(m,n,p,q) = complex_simple3(temp, [u,MVar5]);
end  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
clearvars m n p q
clearvars rhoSub h11Sub T4Sub aMuSub aVSub bVSub
clearvars temp j VarSet VarSubSet
clearvars dh11N dh11Vec dh11_uSub dh11_MuSub d2h11N d2h11_uVec d2h11_MuVec d2h11Vec
clearvars dT4N dT4Vec0 dT4Vec daMuN daMuVec0 daMuVec dfVec0
clearvars dfVec0 dwN dwVec df_conjMuSub d2f_uVec0 d2f_conjMuVec0 d2wN d2wVec
% save('Data_WeylChern_Part2_May30.mat');


