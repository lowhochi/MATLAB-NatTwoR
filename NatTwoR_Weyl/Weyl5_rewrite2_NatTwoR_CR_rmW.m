% Weyl5_rewrite2_NatTwoR_CR_rmW.m
load('DataWeyl2_NatTwoR_CR_rmW.mat');
clearvars myChar myCharR
y = 1+u*conj(u);
% work on the 'w-linear' terms of Weyl curvature tensor
% extract non-w-linear component from every term
W1235 = WeylTwo(11,5); 
% W1415 = WeylTwo(31,5);
% W1425 = WeylTwo(35,5);
W1535 = WeylTwo(50,5);
W1545 = WeylTwo(52,5);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% on W1545 //extract the w-terms
set1545 = symvar(W1545);
wSet1545 = [];
for j=1:length(set1545)
    myChar = char(set1545(j));
    if (strfind(myChar,'dw')==1)
        wSet1545 = [wSet1545, set1545(j)];
        continue
    elseif (strfind(myChar,'d2w')==1)
        wSet1545 = [wSet1545, set1545(j)];
        continue
    elseif (strfind(myChar,'d3w')==1)
        wSet1545 = [wSet1545, set1545(j)];
        continue
    elseif (strfind(myChar,'d4w')==1)
        wSet1545 = [wSet1545, set1545(j)];
        continue      
    elseif (myChar=='w')
        wSet1545 = [wSet1545, set1545(j)];
        continue
    elseif (myChar=='u')
        continue %exclude u from wSet1545
    else
        W1545 = subs(W1545,set1545(j), 0);
    end   
end
wSet1545Two = sym('wSet',[1,2*length(wSet1545)]);
for j=1:length(wSet1545)
    wSet1545Two(j) = wSet1545(j);
    wSet1545Two(length(wSet1545)+j) = conj(wSet1545(j));
end
delta1545 = i/96*(-w*d4w_uuuu + conj(w)*conj(d4w_uuuu))...
    +i/192*(d2w_uu^2 - conj(d2w_uu)^2)...
    +i/96*conj(dw_u)*conj(d3w_uuu) -i/96*dw_u*d3w_uuu...
    +i*conj(u)/(12*y)*w*d3w_uuu -i*u/(12*y)*conj(w)*conj(d3w_uuu)...
    -i*conj(u)^2/(4*y^2)*w*d2w_uu +i*u^2/(4*y^2)*conj(w)*conj(d2w_uu)...
    +i*conj(u)^3/(2*y^3)*w*dw_u -i*u^3/(2*y^3)*conj(w)*conj(dw_u)...
    +i/(2*y^4)*(u^4*conj(w)^2 - conj(u)^4*w^2);
% (1) (delta1545 - W1545) is w-linear
% test1 = W1545 - delta1545;
% test1 = complex_simple3(test1, [u,wSet1545]);
% [termVec, wVec] = coeffs(test1, wSet1545Two);

% (2) replace d4w_uuuu by -i*D2rhoSub in delta1545
D2rhoSub = d2rho_uu +6*i*conj(u)/y*d3w_uuu -24*i*conj(u)^2/y^2*d2w_uu...
    + 60*i*conj(u)^3/y^3*dw_u -72*i*conj(u)^4/y^4*w...
    +12*i*conj(u)/y^3*conj(dw_u) +24*i/y^3*conj(w) -72*i*u*conj(u)/y^4*conj(w);
test2 = subs(delta1545, d4w_uuuu, -i*D2rhoSub);
test2 = complex_simple3(test2, [u,wSet1545]);
% the d2rho_uu component in W1545 is 
%   -1/96*(d2rho_uu*w + conj(d2rho_uu)*conj(w));

% (3) replace d3w_uuu by -i*DrhoSub
DrhoSub = drho_u + 6*i*conj(u)/y*d2w_uu - 18*i*conj(u)^2/y^2*dw_u...
    +24*i*conj(u)^3/y^3*w -6*i/y^2*conj(dw_u) +24*i*u/y^3*conj(w);
test2 = subs(test2, d3w_uuu, -i*DrhoSub);
test2 = complex_simple3(test2, [u,wSet1545,drho_u,d2rho_uu]);

[termVec, rhoVec] = coeffs(test2, [drho_u,d2rho_uu,conj(drho_u),conj(d2rho_uu)]);
% test3=delta1545-a1*drho_u-a2*conj(drho_u)-b1*d2rho_uu-b2*conj(d2rho_uu);
test3 = termVec(end); 
syms phiw
test3 = subs(test3, d2w_uu, phiw+6*conj(u)/y*dw_u-12*conj(u)^2/y^2*w);
test3 = complex_simple3(test3,[u,w,dw_u,phiw]);
% test3 = -(conj(phiw)^2*1i)/192 + (phiw^2*1i)/192

% (4) check that delta1545 is correctly simplified
% temp2 = i*d3w_uuu - 6*i*conj(u)/y*d2w_uu + 18*i*conj(u)^2/y^2*dw_u...
%     -24*i*conj(u)^3/y^3*w + 6*i/y^2*conj(dw_u) -24*i*u/y^3*conj(w); %drh0_u
% temp3 = i*d4w_uuuu -6*i*conj(u)/y*d3w_uuu +24*i*conj(u)^2/y^2*d2w_uu...
%     - 60*i*conj(u)^3/y^3*dw_u +72*i*conj(u)^4/y^4*w...
%     -12*i*conj(u)/y^3*conj(dw_u) -24*i/y^3*conj(w) +72*i*u*conj(u)/y^4*conj(w);
%     %d2rho_uu
% myTemp = -1/96*(w*temp3 +conj(w)*conj(temp3))...
%     -1/96*(dw_u-2*conj(u)/y*w)*temp2 -1/96*(conj(dw_u)-2*u/y*conj(w))*conj(temp2)...
%     +i/192*(phiW^2 - conj(phiW)^2);
% myDiff = myTemp - delta1545;
% myDiff = complex_simple3(myDiff,[u,wSet1545]);

% (5) verify the formula of W1545
W1545 = WeylTwo(52,5);
partOne1545 = -1/96*(w*d2rho_uuSub+conj(w)*conj(d2rho_uuSub))...
    -1/96*(dw_u-2*conj(u)/y*w)*drho_uSub-1/96*(conj(dw_u)-2*u/y*conj(w))*conj(drho_uSub)...
    +rhoSub/192*(phiW+conj(phiW))...
    -i/96*d4w_uuuMu +i/96*conj(d4w_uuuMu)+i*conj(u)/(16*y)*d3w_uuMu...
    -i*u/(16*y)*conj(d3w_uuMu) ...
    +i/24*d3w_uuvnormv -i/24*conj(d3w_uuvnormv)...
    +i*y^2/32*daV_conju*d3w_uuu -i*y^2/32*conj(daV_conju)*conj(d3w_uuu)...
    -(theta/12+i/16*aV-i/16*conj(aV))*(phiW+conj(phiW))...
    +i/(4*y)*(u*conj(d2w_uvnormv) -conj(u)*d2w_uvnormv)...
    +i/(16*y^2)*(conj(d2w_uconjMu)-d2w_uconjMu)...
    +3*i/(16*y^2)*(u^2*conj(d2w_uMu)-conj(u)^2*d2w_uMu)...
    -3*i*conj(u)*y/16*d2w_uu*daV_conju +3*i*u*y/16*conj(d2w_uu)*conj(daV_conju)...
    +i/24*aV*(d2w_uu-conj(d2w_uu))-theta/12*conj(d2w_uu)+i*conj(u)^2/(2*y^2)*dw_vnormv...
    -i*u^2/(2*y^2)*conj(dw_vnormv)...
    +i/(4*y^3)*(conj(u)*dw_conjMu-u*conj(dw_conjMu)+conj(u)^3*dw_Mu -u^3*conj(dw_Mu));
partTwo1545 = (i/8*daV_u-3*i/16*conj(daV_conju)+9*i*conj(u)^2/16*daV_conju)*dw_u...
    +(3*i/16*daV_conju-i/8*conj(daV_u)-9*i*u^2/16*conj(daV_conju))*conj(dw_u)...
    -i*conj(u)/(4*y)*aV*dw_u +u/(4*y)*(2*theta+i*aV)*conj(dw_u)...
    +i/8*w*d2aV_uu -i/8*conj(w)*conj(d2aV_uu)...%update
    -i/8*w*conj(d2aV_conjuconju) +i/8*conj(w)*d2aV_conjuconju... %add
    +(i*conj(u)/(2*y)*conj(daV_conju)-3*i*conj(u)^3/(4*y)*daV_conju)*w... %update
    - i*conj(u)/(4*y)*daV_u*w... %add
    +(3*i/(4*y)*u^3*conj(daV_conju)-i*u/(2*y)*daV_conju)*conj(w)... %update
    + i*u/(4*y)*conj(daV_u)*conj(w)...%add
    +i*conj(u)^2/(2*y^2)*aV*w -u^2/(2*y^2)*(2*theta+i*aV)*conj(w);
    % % % % %
partThree1545 = 3*i*y^3/16*(daV_u*daV_conju+daV_u*conj(daV_u))...
    +3*i*u*y^3/32*(daV_conju+conj(daV_u))*d2aV_uu...
    +i*y^2/16*daV_u*daV_conju -3*i*y^2/16*daV_u*conj(daV_u)...
    -i*y^2/4*conj(daV_u)*conj(daV_conju)...
    -3*i*u*y/32*d3aV_uuMu -3*i*y/16*d2aV_uMu +3*i*u*y/16*d2aV_uvnormv...
    +3*i*u*y/16*(conj(aV)*daV_u-aV*conj(daV_conju))...
    +3*i/16*d2aV_uMu +2/3*dtheta_vnormv +i/2*daV_vnormv...
    -i/2*conj(daV_vnormv) +3*i*u/(16*y)*daV_conjMu...
    -2*i/3*theta^2 +7/6*theta*aV -1/2*theta*conj(aV)...
    +i/2*aV^2 -i/2*aV*conj(aV);

test1545 = W1545 -partOne1545 -partTwo1545 -partThree1545;
test1545 = complex_simple3(test1545, symSetWeylTwo);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% On W1235 
partOne1235 = 1/24*conj(drho_uSub)*conj(w) -i/12*d3w_uuconjMu -i/24*conj(d3w_uuMu)...
    +i/4*conj(d2w_uvnormv) -y^2/24*(2*theta+i*aV-i*conj(aV))*d3w_uuu...
    +i*u/(4*y)*conj(d2w_uMu)+i*conj(u)/(2*y)*d2w_uconjMu...
    -i*u/y*conj(dw_vnormv)+i*y^2/8*conj(d2w_uu)*conj(daV_conju)...
    +conj(u)*y/4*(2*theta+i*aV-i*conj(aV))*d2w_uu...
    -i/(2*y^2)*conj(dw_conjMu) -i*u^2/(2*y^2)*conj(dw_Mu)...
    -i*conj(u)^2/y^2*dw_conjMu +3*i*y^2/8*dw_u*d2aV_uu...
    +3*i*conj(u)*y/4*dw_u*daV_u -3*i*u*y/4*conj(dw_u)*conj(daV_conju)...
    -3*conj(u)^2/4*(2*theta+i*aV-i*conj(aV))*dw_u...
    +(1/2*theta+i/4*aV)*conj(dw_u) -3*i*conj(u)*y/2*w*d2aV_uu...
    -3*i*conj(u)^2*w*daV_u...
    +(3*i*u^2/2*conj(daV_conju)+i*conj(daV_u)-i/2*daV_conju)*conj(w)...
    +conj(u)^3/y*(2*theta+i*aV-i*conj(aV))*w -u/y*(2*theta+i*aV)*conj(w);
partTwo1235 = -3*i*y^4/16*(daV_conju+conj(daV_u))*d2aV_uu...
    +i*conj(u)*y^3/8*(-5*daV_u*daV_conju+2*conj(daV_conju)*conj(daV_u)-3*daV_u*conj(daV_u))...
    +5*i*y^2/16*d3aV_uuMu +i*y^2/8*d2aV_uvnormv -i*y^2/4*conj(d2aV_conjuvnormv)...
    +i*y^2/8*conj(aV)*daV_u-y^2*(theta+5*i/8*aV-i/2*conj(aV))*conj(daV_conju)...
    +5*i*conj(u)*y/8*d2aV_uMu +i*conj(u)*y/4*d2aV_conjuconjMu...
    -i*conj(u)*y/4*conj(d2aV_conjuconjMu)-i*conj(u)*y/2*daV_vnormv...
    +i*conj(u)*y/2*conj(daV_vnormv)-conj(u)*y*dtheta_vnormv...
    -conj(u)*y/2*(aV+conj(aV))*(2*theta+i*aV-i*conj(aV))...
    -3*i/8*daV_conjMu +i/4*conj(daV_Mu) -1/3*dtheta_conjMu;
test1235 = W1235 -partOne1235 -partTwo1235;
test1235 = complex_simple3(test1235, symSetWeylTwo);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% On W1535
partOne1535 = -1/(12*y^2)*conj(w)*rhoSub -i/48*d4w_uuuconjMu...
   +i*conj(u)/(8*y)*d3w_uuconjMu -i*y^2/48*d3w_uuu*daV_u...
   -3*i*conj(u)^2/(8*y^2)*d2w_uconjMu +i/(8*y^2)*conj(d2w_uMu)...
   +5*i*y^2/48*d2w_uu*d2aV_uu +i*y^2/48*conj(d2w_uu)*d2aV_uu...
   +i*conj(u)*y/3*d2w_uu*daV_u +i*conj(u)*y/24*conj(d2w_uu)*daV_u...
   +i*conj(u)^3/(2*y^3)*dw_conjMu -i*u/(2*y^3)*conj(dw_Mu) -i/y^2*conj(dw_vnormv)...
   -5*i*conj(u)*y/8*dw_u*d2aV_uu -i*y/8*(u*d2aV_uu+2*daV_u)*conj(dw_u)...
   -13*i*conj(u)^2/8*dw_u*daV_u+(3*i/8*daV_u-i/2*conj(daV_conju))*conj(dw_u)...
   +5*i*conj(u)^2/4*w*d2aV_uu+i/4*(u^2*d2aV_uu+2*u*daV_u)*conj(w)...
   +3*i*conj(u)^3/y*w*daV_u+i*u/y*(-daV_u+2*conj(daV_conju))*conj(w)...
   +1/y^2*(theta+i*aV-2*i*conj(aV))*conj(w);
partTwo1535 = -3*i*conj(u)*y^3/32*(daV_conju+conj(daV_u))*d2aV_uu...
    +i*y^2/2*d3aV_uuvnormv...
    +y^2*(theta/6+i/2*conj(aV))*d2aV_uu +i*y^2/2*(conj(daV_conju))^2 ...
    -i*y^2/2*daV_u*conj(daV_conju)-3*i*conj(u)^2*y^2/16*daV_u*daV_conju...
    -3*i*conj(u)^2*y^2/16*daV_u*conj(daV_u) +3*i*conj(u)*y/32*d3aV_uuMu...
    +13*i*conj(u)*y/16*d2aV_uvnormv +conj(u)*y*(theta/3+13*i/16*conj(aV))*daV_u...
    +3*i*conj(u)*y/16*aV*conj(daV_conju) +3*i*conj(u)^2/16*d2aV_uMu...
    -3*i*conj(u)/(16*y)*daV_conjMu;
test1535 = W1535 -partOne1535 -partTwo1535;
test1535 = complex_simple3(test1535, symSetWeylTwo);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%